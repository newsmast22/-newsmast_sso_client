- user ||= @user
- destination ||= false

= form_for user, url: droom_client.set_password_user_path(user), method: "PUT" do |f|
  = hidden_field_tag :tok, user.unique_session_id
  - if destination
    = hidden_field_tag :destination, destination

  %fieldset{data: {role: 'password'}}
    %p.set_password
      %span.col.password>
        = f.label :password, class: "required"
        = f.password_field :password, placeholder: "Six characters or more, please", required: true, data: {role: "password"}
      %span.col.confirmation{:data => {:role => "confirmation"}}>
        = f.label :password_confirmation, class: "required"
        = f.password_field :password_confirmation, placeholder: "", required: true

    %p.password_quality.floating{data: {role: "meter"}}
      %span.instructions{data: {role: "warnings"}}
      %span.meter{data: {role: "gauge"}}
        %svg
          %use{"xlink:href" => "#warning_symbol"}
    
    = f.submit "Continue"
    
    %p
      %span.notes{data: {role: "notes"}}
        When the password is strong enough, the 'confirmation' box will become available, and when the two passwords match the 'continue' button will go green and become clickable.
        Dictionary words, repetition and common passwords are likely to be rejected. Please add complication, either in the form of punctuation and strange characters or just by adding more words.
